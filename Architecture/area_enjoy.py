#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Thu Jan 19 11:30:20 2017

@author: anr.putina
"""

import geopandas as gpd
from shapely.geometry import Point, Polygon

def create_zones_enjoy():

	Data = {"arrayPolygonCoordinates":[{"lat":"45.04978973149365","lon":"7.688085992391454"},{"lat":"45.05217925525396","lon":"7.689537156636003"},{"lat":"45.05393859278905","lon":"7.691244104013388"},{"lat":"45.05510350698171","lon":"7.691869680067187"},{"lat":"45.05691656641791","lon":"7.692943657557207"},{"lat":"45.05761619822891","lon":"7.693461284795699"},{"lat":"45.06154891406602","lon":"7.697342057322791"},{"lat":"45.06250227975797","lon":"7.698466236842805"},{"lat":"45.06358458536685","lon":"7.699824719857284"},{"lat":"45.06480371714132","lon":"7.703248214930234"},{"lat":"45.06703368356656","lon":"7.709084648211864"},{"lat":"45.06752492721281","lon":"7.711063034671639"},{"lat":"45.06805118496578","lon":"7.714039841215962"},{"lat":"45.06851324230581","lon":"7.716496583513739"},{"lat":"45.06918415561519","lon":"7.720428924055849"},{"lat":"45.06970481894829","lon":"7.72350528922124"},{"lat":"45.06991419554656","lon":"7.724825855809461"},{"lat":"45.07009431916616","lon":"7.726708338133863"},{"lat":"45.07278507194097","lon":"7.729111916986213"},{"lat":"45.07516806946759","lon":"7.730687303625174"},{"lat":"45.07523066055904","lon":"7.727710093571325"},{"lat":"45.07556905249544","lon":"7.727549400085467"},{"lat":"45.07587522445998","lon":"7.72711876043237"},{"lat":"45.07617996107626","lon":"7.726829659706311"},{"lat":"45.07652288765128","lon":"7.726571966930314"},{"lat":"45.07781212893973","lon":"7.725344271468561"},{"lat":"45.07792428853371","lon":"7.724721786052609"},{"lat":"45.07751211466708","lon":"7.723857621275252"},{"lat":"45.0773088626227","lon":"7.722541281283684"},{"lat":"45.07664238522891","lon":"7.71984113167616"},{"lat":"45.07597497489195","lon":"7.71813124851354"},{"lat":"45.07562966223832","lon":"7.717649003699158"},{"lat":"45.07410457067591","lon":"7.715839186830209"},{"lat":"45.07370134740271","lon":"7.715245414548846"},{"lat":"45.07359318754906","lon":"7.713564541102375"},{"lat":"45.07445226338234","lon":"7.711495932717309"},{"lat":"45.07495294248599","lon":"7.709837130383037"},{"lat":"45.07528386580511","lon":"7.707692392050564"},{"lat":"45.07537264661745","lon":"7.706309945871812"},{"lat":"45.07532653234696","lon":"7.704898861309156"},{"lat":"45.0756965437467","lon":"7.704520608649821"},{"lat":"45.07600160850772","lon":"7.704106632640649"},{"lat":"45.0767678308566","lon":"7.70319416947838"},{"lat":"45.07737248803495","lon":"7.702639847013031"},{"lat":"45.07801694319959","lon":"7.702084031041682"},{"lat":"45.07852144460851","lon":"7.701600247084148"},{"lat":"45.07912659590074","lon":"7.701081370050669"},{"lat":"45.07938524299819","lon":"7.70093430007581"},{"lat":"45.07954092301654","lon":"7.700915118980179"},{"lat":"45.07954834207517","lon":"7.700911148098215"},{"lat":"45.07970786789439","lon":"7.70100347404936"},{"lat":"45.07980018014753","lon":"7.700925841219714"},{"lat":"45.08333562325491","lon":"7.697756674146725"},{"lat":"45.08929699596642","lon":"7.711072748823122"},{"lat":"45.09398172919727","lon":"7.715944167588895"},{"lat":"45.09473275499538","lon":"7.717006288812247"},{"lat":"45.09498912416929","lon":"7.716918187321284"},{"lat":"45.10044315386496","lon":"7.707638204013987"},{"lat":"45.10097988751964","lon":"7.706005137830045"},{"lat":"45.10243763698526","lon":"7.7008996316251"},{"lat":"45.10274507285303","lon":"7.700342854276814"},{"lat":"45.10266280604289","lon":"7.699869413595595"},{"lat":"45.1036537689703","lon":"7.69560098484646"},{"lat":"45.10396513477011","lon":"7.691918824514838"},{"lat":"45.10436481357295","lon":"7.684356927282529"},{"lat":"45.10559053511687","lon":"7.66348293352883"},{"lat":"45.10498259980235","lon":"7.662767191862814"},{"lat":"45.10356891209891","lon":"7.662107260912128"},{"lat":"45.09226254195119","lon":"7.654454563302702"},{"lat":"45.08521232713083","lon":"7.649699569900719"},{"lat":"45.08543176346184","lon":"7.648737808310411"},{"lat":"45.08554698501668","lon":"7.647717467418813"},{"lat":"45.08547677671739","lon":"7.646565816161115"},{"lat":"45.0850514741332","lon":"7.64329271625027"},{"lat":"45.08476690511933","lon":"7.639825459933731"},{"lat":"45.0854092527894","lon":"7.635405519225758"},{"lat":"45.08532206624767","lon":"7.632378093329464"},{"lat":"45.08549196589283","lon":"7.63101982210503"},{"lat":"45.08669555340501","lon":"7.627534413421042"},{"lat":"45.08708081190698","lon":"7.625914700943561"},{"lat":"45.08113732075694","lon":"7.623431138415969"},{"lat":"45.0789001386242","lon":"7.621366358168169"},{"lat":"45.07612836514425","lon":"7.619817227064214"},{"lat":"45.07470132660906","lon":"7.619279980375358"},{"lat":"45.07026047217025","lon":"7.618188803281396"},{"lat":"45.06726863095979","lon":"7.620680617221922"},{"lat":"45.05744927216561","lon":"7.628620733521756"},{"lat":"45.05394635382152","lon":"7.629610652240332"},{"lat":"45.0503384754941","lon":"7.629405525632493"},{"lat":"45.03761924966013","lon":"7.628366401294797"},{"lat":"45.03552240074782","lon":"7.624144976478808"},{"lat":"45.03509275135804","lon":"7.625289341329808"},{"lat":"45.03042771782398","lon":"7.639436460655642"},{"lat":"45.02338155706622","lon":"7.634480219538606"},{"lat":"45.03025227213024","lon":"7.616687241241649"},{"lat":"45.02986066850114","lon":"7.616423647391082"},{"lat":"45.02292598509848","lon":"7.634156861487091"},{"lat":"45.02129079096913","lon":"7.633096993463326"},{"lat":"45.01998775705157","lon":"7.631432238071987"},{"lat":"45.02408177338802","lon":"7.621014930520246"},{"lat":"45.01917842336125","lon":"7.61875498028008"},{"lat":"45.02395736394874","lon":"7.606635674699387"},{"lat":"45.01804185497029","lon":"7.603307673119111"},{"lat":"45.01318973584428","lon":"7.624347927727115"},{"lat":"45.01263605292308","lon":"7.624741710990072"},{"lat":"45.01068966188106","lon":"7.636565805435089"},{"lat":"45.01770145889503","lon":"7.639018437155027"},{"lat":"45.02079125725105","lon":"7.640065911242575"},{"lat":"45.01822794809703","lon":"7.64355233607181"},{"lat":"45.01722434744522","lon":"7.647790019906012"},{"lat":"45.01583562933017","lon":"7.648203078263729"},{"lat":"45.0105933715551","lon":"7.649435385510035"},{"lat":"45.00931406259747","lon":"7.649808300257397"},{"lat":"45.00953696464478","lon":"7.651483331092733"},{"lat":"45.00826675166253","lon":"7.658075460825318"},{"lat":"45.01733491596308","lon":"7.661722114950404"},{"lat":"45.01729120470365","lon":"7.662033978079985"},{"lat":"45.01684270680271","lon":"7.664375170465143"},{"lat":"45.01669779713931","lon":"7.665129893335503"},{"lat":"45.01760357623564","lon":"7.665516391441043"},{"lat":"45.01710114980313","lon":"7.667884278921275"},{"lat":"45.01688578035727","lon":"7.668315771809655"},{"lat":"45.01702434973636","lon":"7.668940804049161"},{"lat":"45.0243589627063","lon":"7.671477117844667"},{"lat":"45.02629203989305","lon":"7.672077569013933"},{"lat":"45.02545854550159","lon":"7.673326902312727"},{"lat":"45.02507998047744","lon":"7.67637184929832"},{"lat":"45.02628053401914","lon":"7.676659601855961"},{"lat":"45.02879121407246","lon":"7.677779423464664"},{"lat":"45.03062347717715","lon":"7.678567348005936"},{"lat":"45.03217289007876","lon":"7.679247326111658"},{"lat":"45.0347140180202","lon":"7.680436776342448"},{"lat":"45.0366017407143","lon":"7.681244770003566"},{"lat":"45.0385347005467","lon":"7.682093860250639"},{"lat":"45.03998250362817","lon":"7.682769840522137"},{"lat":"45.0404232406397","lon":"7.6830064747366"},{"lat":"45.04224988288666","lon":"7.684366259865536"},{"lat":"45.04364095875538","lon":"7.685351447518654"},{"lat":"45.04452860205421","lon":"7.685927324108488"},{"lat":"45.04509266338577","lon":"7.684357400687604"},{"lat":"45.04580127394226","lon":"7.684764764693712"},{"lat":"45.04650693676435","lon":"7.684220298266289"},{"lat":"45.04664387766146","lon":"7.684039252147052"},{"lat":"45.04726399982129","lon":"7.683850461878155"},{"lat":"45.04798746489552","lon":"7.683714014453176"},{"lat":"45.04905343010512","lon":"7.683233014894253"},{"lat":"45.04981339993965","lon":"7.682804621522177"},{"lat":"45.05019710224818","lon":"7.683001214569519"},{"lat":"45.05041516156327","lon":"7.68233695676148"},{"lat":"45.05065116106978","lon":"7.6817592303117"},{"lat":"45.05121378565455","lon":"7.68219900086955"},{"lat":"45.0590985990507","lon":"7.687988226947073"},{"lat":"45.05776398539559","lon":"7.692069002026405"},{"lat":"45.05550387907069","lon":"7.689614525003337"},{"lat":"45.05325217175395","lon":"7.687880825842464"},{"lat":"45.05055551643978","lon":"7.686766312875248"},{"lat":"45.04694320927235","lon":"7.685980877575389"},{"lat":"45.04508472991892","lon":"7.685016721493576"},{"lat":"45.04474172319626","lon":"7.686010069414935"},{"lat":"45.04659418962594","lon":"7.687007264647024"},{"lat":"45.04857793266096","lon":"7.687411654908301"},{"lat":"45.04978973149365","lon":"7.688085992391454"}],"arrayCoverageAreaType":[["500"]],"parkingLatitude":45.05751,"parkingLongitude":7.677656}

	array = Data['arrayPolygonCoordinates']

	Shape = []
	for p in array:
	    Shape.append(['enjoy_shape', Point(float(p['lon']), float(p['lat']))])

	zones_enjoy = gpd.GeoDataFrame( Shape,  
	                     columns = ['shape_id','geometry'], 
	                     geometry='geometry')

	zones_enjoy['geometry'] = zones_enjoy['geometry'].apply(lambda x: x.coords[0])

	zones_enjoy = zones_enjoy.groupby('shape_id')['geometry'].apply(lambda x: Polygon(x.tolist())).reset_index()

	zones_enjoy = gpd.GeoDataFrame(zones_enjoy, geometry = 'geometry')

	return zones_enjoy