#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Thu Jan 19 12:56:40 2017

@author: anr.putina
"""

import geopandas as gpd
from shapely.geometry import Point, Polygon

Data = {"placemarks":[{"coordinates":[7.724891,45.07212,0,7.726738,45.073833,0,7.727551,45.075436,0,7.725174,45.077637,0,7.721904,45.077065,0,7.718173,45.07594,0,7.714741,45.08044,0,7.704541,45.07595,0,7.697794,45.08331,0,7.700742,45.084637,0,7.700814,45.08458,0,7.701205,45.084747,0,7.701269,45.084892,0,7.704943,45.08655,0,7.711079,45.089195,0,7.71288,45.089115,0,7.713206,45.088886,0,7.714944,45.08892,0,7.715174,45.091587,0,7.715431,45.093426,0,7.715963,45.093517,0,7.716455,45.093853,0,7.71793,45.09506,0,7.717507,45.095497,0,7.716911,45.095608,0,7.716499,45.095284,0,7.711464,45.09816,0,7.707574,45.10049,0,7.704139,45.101562,0,7.70183,45.10208,0,7.702415,45.10325,0,7.703187,45.10468,0,7.703773,45.1045,0,7.704003,45.10487,0,7.702628,45.105263,0,7.702429,45.104893,0,7.70224,45.104614,0,7.701853,45.104782,0,7.701532,45.104885,0,7.700431,45.10534,0,7.70035,45.105167,0,7.698189,45.105885,0,7.69695,45.10615,0,7.696466,45.106354,0,7.695091,45.10371,0,7.684641,45.104366,0,7.66168,45.105713,0,7.655645,45.11119,0,7.654647,45.11071,0,7.653871,45.11013,0,7.653377,45.109676,0,7.645632,45.111687,0,7.645652,45.11186,0,7.645199,45.11188,0,7.64447,45.111813,0,7.643688,45.111374,0,7.644173,45.110886,0,7.644593,45.110275,0,7.644744,45.109455,0,7.64477,45.10903,0,7.644599,45.10847,0,7.644453,45.108208,0,7.644007,45.107697,0,7.643391,45.10807,0,7.6427,45.107697,0,7.642158,45.107616,0,7.641416,45.107594,0,7.640316,45.107754,0,7.63959,45.10808,0,7.638569,45.10748,0,7.638442,45.107616,0,7.63798,45.107395,0,7.637965,45.106953,0,7.637935,45.10628,0,7.637515,45.106277,0,7.637297,45.103943,0,7.637353,45.102207,0,7.656499,45.096863,0,7.657149,45.096382,0,7.65358,45.091076,0,7.652126,45.088814,0,7.651193,45.08755,0,7.648296,45.083233,0,7.644163,45.08337,0,7.63978,45.083508,0,7.636707,45.0836,0,7.633062,45.083736,0,7.630526,45.083836,0,7.620056,45.084255,0,7.616446,45.08535,0,7.616256,45.082394,0,7.61595,45.08239,0,7.615896,45.07976,0,7.618365,45.07966,0,7.618046,45.0774,0,7.619027,45.07735,0,7.618708,45.07515,0,7.618534,45.074734,0,7.617603,45.07471,0,7.616066,45.07465,0,7.608104,45.074375,0,7.606612,45.07431,0,7.606892,45.071156,0,7.609302,45.071198,0,7.609523,45.068672,0,7.614178,45.06887,0,7.615012,45.068897,0,7.615086,45.068096,0,7.61481,45.06784,0,7.614931,45.066727,0,7.6146,45.066776,0,7.614642,45.06617,0,7.615362,45.066208,0,7.615855,45.066082,0,7.618054,45.06493,0,7.617971,45.06463,0,7.621025,45.0644,0,7.623031,45.064262,0,7.626883,45.059647,0,7.62793,45.058235,0,7.628754,45.057106,0,7.629056,45.056423,0,7.6292,45.055603,0,7.629414,45.05423,0,7.629517,45.053772,0,7.629332,45.050804,0,7.627305,45.05087,0,7.627146,45.048714,0,7.626796,45.044514,0,7.624745,45.04523,0,7.62441,45.041935,0,7.62331,45.04187,0,7.622883,45.04156,0,7.620089,45.03928,0,7.618849,45.038303,0,7.618226,45.037758,0,7.617995,45.03756,0,7.617735,45.037106,0,7.620368,45.03629,0,7.623974,45.035572,0,7.625275,45.03514,0,7.630221,45.033485,0,7.633213,45.032486,0,7.634814,45.031918,0,7.636072,45.031513,0,7.63801,45.030888,0,7.639043,45.03053,0,7.639466,45.030373,0,7.638305,45.02873,0,7.637454,45.027534,0,7.636961,45.02682,0,7.636454,45.026154,0,7.635962,45.025463,0,7.635601,45.024956,0,7.635177,45.024357,0,7.63471,45.023655,0,7.634515,45.023354,0,7.634003,45.0227,0,7.633091,45.02138,0,7.632166,45.02053,0,7.630549,45.019085,0,7.629541,45.018185,0,7.628262,45.017056,0,7.627404,45.016285,0,7.624029,45.01725,0,7.624464,45.017815,0,7.625071,45.018383,0,7.624151,45.018894,0,7.62554,45.021378,0,7.622945,45.022484,0,7.621952,45.022865,0,7.620883,45.023453,0,7.61885,45.019173,0,7.61292,45.02148,0,7.611316,45.019203,0,7.609503,45.016697,0,7.61355,45.015736,0,7.615909,45.015163,0,7.617225,45.0149,0,7.620445,45.01417,0,7.623528,45.013447,0,7.623987,45.01333,0,7.624296,45.012974,0,7.624806,45.012787,0,7.630975,45.011593,0,7.636978,45.01059,0,7.639538,45.017662,0,7.643357,45.018074,0,7.647772,45.017162,0,7.648685,45.013573,0,7.653075,45.0127,0,7.65724,45.011906,0,7.658958,45.016014,0,7.658683,45.016647,0,7.656721,45.016743,0,7.656714,45.01718,0,7.658254,45.017178,0,7.658328,45.01729,0,7.658639,45.017326,0,7.659219,45.017517,0,7.659954,45.017673,0,7.664532,45.0168,0,7.664953,45.01673,0,7.665249,45.017097,0,7.665696,45.01795,0,7.667187,45.021378,0,7.669094,45.025764,0,7.670036,45.02795,0,7.671831,45.028877,0,7.672231,45.02999,0,7.672868,45.02984,0,7.674113,45.031055,0,7.674774,45.031883,0,7.675501,45.03306,0,7.67594,45.03422,0,7.676099,45.035435,0,7.675143,45.036224,0,7.675969,45.036648,0,7.675973,45.037388,0,7.675816,45.038284,0,7.675827,45.03924,0,7.676233,45.03924,0,7.676202,45.03962,0,7.676298,45.0401,0,7.676401,45.040665,0,7.676699,45.041267,0,7.677486,45.041363,0,7.679218,45.040775,0,7.679402,45.040413,0,7.680466,45.04025,0,7.681225,45.039707,0,7.679629,45.037422,0,7.679262,45.03751,0,7.679054,45.035866,0,7.680381,45.03557,0,7.679527,45.033638,0,7.679025,45.03241,0,7.678835,45.03204,0,7.678618,45.03148,0,7.677695,45.029438,0,7.677445,45.028942,0,7.677812,45.028847,0,7.680132,45.03403,0,7.681131,45.035904,0,7.683009,45.04005,0,7.686065,45.04466,0,7.684381,45.045345,0,7.684771,45.046494,0,7.684065,45.04675,0,7.683547,45.048664,0,7.682976,45.04967,0,7.683161,45.050045,0,7.684205,45.050594,0,7.683783,45.050854,0,7.68334,45.050503,0,7.682987,45.05046,0,7.682628,45.050632,0,7.682756,45.050953,0,7.683983,45.0522,0,7.684817,45.051815,0,7.685126,45.052174,0,7.684543,45.05256,0,7.684582,45.052784,0,7.685675,45.054745,0,7.684972,45.054955,0,7.688049,45.059177,0,7.690376,45.058403,0,7.689739,45.058117,0,7.689323,45.057575,0,7.689036,45.05705,0,7.689335,45.056988,0,7.689677,45.05759,0,7.689986,45.057953,0,7.69077,45.058254,0,7.692892,45.057514,0,7.69192,45.056103,0,7.69156,45.055267,0,7.690932,45.055508,0,7.689686,45.05406,0,7.690171,45.05385,0,7.689397,45.05304,0,7.689197,45.05221,0,7.690059,45.05185,0,7.691417,45.05302,0,7.692811,45.053837,0,7.69566,45.05496,0,7.696962,45.055637,0,7.697708,45.056263,0,7.698066,45.056618,0,7.698597,45.057537,0,7.698736,45.058125,0,7.698971,45.05823,0,7.699151,45.059254,0,7.698956,45.06006,0,7.69916,45.06022,0,7.700926,45.061638,0,7.705521,45.059338,0,7.705727,45.05944,0,7.705774,45.060665,0,7.707215,45.061405,0,7.70931,45.062492,0,7.712362,45.06385,0,7.713043,45.063858,0,7.713248,45.06416,0,7.714161,45.06476,0,7.714469,45.064716,0,7.714745,45.0649,0,7.714729,45.065136,0,7.71723,45.065945,0,7.718234,45.066254,0,7.719989,45.06654,0,7.720564,45.0666,0,7.722309,45.066414,0,7.723243,45.06718,0,7.722432,45.067722,0,7.723825,45.068794,0,7.724189,45.068897,0,7.723773,45.069717,0,7.724891,45.07212,0],"name":"20160329 Torino","zoneType":"included"},{"coordinates":[7.64282,45.188713,0,7.643432,45.188293,0,7.64377,45.187817,0,7.643904,45.187836,0,7.643503,45.18877,0,7.643362,45.18874,0,7.643078,45.188755,0],"name":"Aeroporto Caselle 2","zoneType":"parking"},{"coordinates":[7.582819,45.098213,0,7.582392,45.09855,0,7.583056,45.09893,0,7.583488,45.09861,0],"name":"IKEA","zoneType":"parking"}]}


def create_zones_car2go(zoneType):

	if zoneType == 'airport':
		ZoneType = 1
	elif zoneType == 'ikea':
		ZoneType = 2
	else:
		ZoneType = 0

	array = Data['placemarks'][ZoneType]['coordinates']

	N=3
	subList = [array[n:n+N] for n in range(0, len(array), N)]

	Shape = []
	for p in subList:
	    Shape.append(['car2go_shape', Point(float(p[0]), float(p[1]))])

	    
	zones = gpd.GeoDataFrame( Shape,  
	                     columns = ['shape_id','geometry'], 
	                     geometry='geometry')



	zones['geometry'] = zones['geometry'].apply(lambda x: x.coords[0])

	zones = zones.groupby('shape_id')['geometry'].apply(lambda x: Polygon(x.tolist())).reset_index()

	zones = gpd.GeoDataFrame(zones, geometry = 'geometry')

	return zones